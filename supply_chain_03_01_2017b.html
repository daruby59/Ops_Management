<html>
  <head>  
    <title>Kanban Systems</title>
    <script type="text/javascript">  
	//
	// Feb 22, 2017
	//
	// notes:
	// need to add changes in arrival frequencies
	// need to add functionality for a second server.
	//
	// from Mkt_sim.java
	//
	var flag=2;
	//
	// housekeeping
	//
	var a=0;
	var b=0;
	var a2=0;
	var b2=0;
	var i=0;
	var j=0;
	var k=1;
	var index=10;
	var j2=0;
	var key2=0;
	var key3=0;
	var key4=5.00;
	var x1 = 0;
	var x2 = 0;
	var x3 = 0;
	var x4 = 0;
	var flag=2;
	var server1_flag = 0;
	var server2_flag = 0;
	var server3_flag = 0;
	var server4_flag = 0;
	var multiple = 1.0;
	var server_count = 1;
	var flag2=0;
	var toggle = -1;
	var toggle1 = -1;
	var rnd_toggle = -1;
	//
	var ia = 1;
	// var z0 = [0.779,0.607,0.472,0.368,0.287,0.223,0.174,0.135];
	// var z1 = [0.974,0.910,0.826,0.736,0.645,0.558,0.478,0.406];
	// var z2 = [0.998,0.986,0.959,0.920,0.869,0.809,0.744,0.677];
	// var z3 = [1.000,0.999,0.992,0.981,0.962,0.935,0.899,0.857];
	// var z4 = [1.000,1.000,0.998,0.996,0.991,0.982,0.967,0.947];
	// var z5 = [1.000,1.000,0.999,0.999,0.998,0.996,0.991,0.983];
	// var z6 = [1.000,1.000,1.000,1.000,1.000,1.000,0.998,0.995];
	//
	var ia_index = [0.10,0.20,0.25,0.30,0.33,0.40,0.50]
	var z0 = [0.905,0.819,0.779,0.741,0.719,0.67,0.607];
	var z1 = [0.995,0.981,0.974,0.963,0.956,0.938,0.91];
	var z2 = [1,0.997,0.998,0.996,0.994,0.992,0.986];
	var z3 = [1,0.998,0.999,0.999,0.999,0.999,0.999];
	//
	var  customer_arrive = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0];
	var  customer_wait = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0];
	var  service_time = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0];
	var  service1_time = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0];
	var  service2_time = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0];
	var  service3_time = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0];
	var  service4_time = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0];
	var  server_begin = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0];
  	var  server1_begin = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0];
	var  server2_begin = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0];
	var  server3_begin = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0];
	var  server4_begin = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0];
	var queue_length = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0];
	//
	var arrival = 0;
	var queue = 20;
	var queue1 = 0;
	var queue2 = 0;
	var queue3 = 0;
	var queue4 = 0;
	//
	var xx = 0;
	var server_time = 3;
	var xy1 = 0;
	var xy2 = 0;
	var xy3 = 0;
	var xy4 = 0;
	var xz = 0;
	//
	var customer_count = 0;
	var service1_count = 0;
	var service2_count = 0;
	var service3_count = 0;
	var service4_count = 0;
	var customer_index = 0;
	//
                    var color_index = 0;
	var s_time1 = 3;
	var s_time2 = 3;
	var s_time3 = 3;
	var s_time4 = 3;
	var arrival_total = 0;
	var completed = 0;
	var buffer = 0;
	//
	//
	//
	var lbl = ["0","1","2","3","4","5","6","7","8","9","10","11","12"];
	var lbl1 = ["0.0","1.0","2.0","3.0","4.0","5.0","6.0","7.0","8.0","9.0","10.0","11.0","12.0"];
	var lbl2 = ["0","10","20","30","40","50","60","70","80","90","100","110","120","130","140"];
	//	
	// color choices
	//
	var  rr = 0;
  	var  gg = 0;
  	var  bb = 0;
	var sb_code = ["red","maroon","magenta","purple","green","pine","teal","blue","navy","aqua","thunder","snow","orange","silver","gray","black","white","yellow",
	"dgreen","dawn","psx","csx","sky","rose","azure","sunrise"];
	var rr_code =  [255,128,255,102,000,000,000,000,000,000,100,224,255,192,164,000,255,255,033,041,000,100,062,195,000,176,000,000];
	var gg_code = [000,000,000,102,255,128,128,000,000,255,150,224,148,192,164,000,255,255,137,156,153,150,090,030,107,128,000,000];
	var bb_code = [000,000,255,255,000,000,128,255,128,255,220,224,000,192,164,000,255,000,041,052,000,220,181,128,132,080,000,000];
	//
function setColor(cl) {
var canvas = document.getElementById('incidence');  
        if (canvas.getContext){  
              var gS2 = canvas.getContext('2d');  
        }
       // default black
       rr = 0;
       gg = 0;
       bb = 0;
       //
       for (k=0;k<26;k++) {
          if(cl == sb_code[k]) {
            rr = rr_code[k];
            gg = gg_code[k];
            bb = bb_code[k];
            gS2.strokeStyle = "rgb("+rr+","+gg+","+bb+")";
           gS2.fillStyle = "rgb("+rr+","+gg+","+bb+")";
         }
     }
}
//
function setFont(fx) {
var canvas = document.getElementById('incidence');  
        	if (canvas.getContext){  
                       var gS2 = canvas.getContext('2d');  
            	}  
	if (fx == "f") {
	  gS2.font = "bold 14px Arial";
	}
	if (fx == "f2") {
	   gS2.font = "bold 12px Arial";
	}
	if (fx == "f3") {
	   gS2.font = "10px Arial";
	}
	if (fx == "f4") {
	  gS2.font = "12px Arial";
	}
      gS2.fillStyle = "rgb("+rr+","+gg+","+bb+")"; 
} 
// 
function drawLine(x1,y1,x2,y2) { 
	var canvas = document.getElementById('incidence');  
        	if (canvas.getContext){  
                       var gS2 = canvas.getContext('2d');  
            	}  
	gS2.strokeStyle = "rgb("+rr+","+gg+","+bb+")";
	gS2.lineWidth=1;
	gS2.beginPath();  
	gS2.moveTo(x1,y1);
	gS2.lineTo(x2,y2);
	gS2.closePath;
  	gS2.stroke();
}
//
function drawRect(x1,y1,x2,y2) {
	var canvas = document.getElementById('incidence');  
        	if (canvas.getContext){  
                        var gS2 = canvas.getContext('2d');  
            	}  
	gS2.strokeStyle = "rgb("+rr+","+gg+","+bb+")";
                    gS2.beginPath();
	gS2.moveTo(x1,y1);
	gS2.lineTo(x1+x2,y1);
	gS2.lineTo(x1+x2,y1+y2);
	gS2.lineTo(x1,y1+y2);
	gS2.closePath();
	gS2.stroke();
}
//
function init1() {
	//
	server1_flag = 0;
	server2_flag = 0
	server_count = 1;
	flag2=0;
	toggle = -1;
	toggle1 = -1;
	//
                    arrival = 0;
	queue = 20;
	xx = 0;
	server_time = 3;
	xy = 0;
	xz = 0;
	x3 = 0;
	x4 = 0;
	customer_count = 0;
	customer_index = 0;
                    color_index = 0;
	s_time1 = 3;
	s_time2 = 3;
	s_time3 = 3;
	s_time4 = 3;
	arrival_total = 0;
	ia = 1;
	//
	for (k = 0;k<40;k++) {
	  customer_arrive = [k];
	  customer_wait = [k];
	  service1_time[k] = 0;
	  service2_time[k] = 0;
	  service3_time[k] = 0;
	  service4_time[k] = 0;
	  server_begin[k] = 0;
	  server1_begin[k] = 0;
	  server2_begin[k] = 0;
	  server3_begin[k] = 0;
	  server4_begin[k] = 0;
	  queue_length = [k];
	}
	//
	draw();
}
//
function randomize() {
rnd_toggle = rnd_toggle*(-1);
draw();
}
// 
function summary() {
toggle = toggle*(-1);
  draw();
}
//
function doit5(bx) {
buffer = bx*1.0;
draw();
}
//
function doit4(yx) {
  s_time4 = yx*multiple;
draw();
}
//
function doit3(vx) {
  s_time3 = vx*multiple;
draw();
}
//
function doit2(ux) {
  s_time2 = ux*multiple;
  draw()
}
function doit1(tx) {
  s_time1 = tx*multiple;
draw();
}
//
// clock updates here
//
function runner() {
  	//
	flag3=1;
	flag=1;
  	x4 = 0
	//
    	myVar=setInterval(function(){update()},100);
    	function update() {
     		//
    		x4=x4+1;
		//
      		if (x4 < 361) {
      		     x3 = x3 + 1;
		     //
                                             // server #1 is available
		     //
		     if (server1_flag == 0 && queue > 0) {
		         server1_flag = 1;
		         customer_count = customer_count + 1;
		         if (queue > 0) {
		              queue = queue -1;
		              service1_count = service1_count + 1;
		         }
		         if (rnd_toggle < 0) {
		         server_time = 1+ Math.round(Math.random()*(s_time1)*10.0)/10.0;
		         }
		         else {
		            server_time = s_time1;
		         }
		         service1_time[service1_count] = server_time;
                                                 server1_begin[service1_count] = (x4/6);
		         queue_length[service1_count] = queue;
		     }
		     //
		     if (server1_flag ==1) {
		         xy1 = xy1 +1;
		         if (xy1 > service1_time[service1_count]*6) {
		            server1_flag = 0;
		            xy1 = 0;
		            queue2 = queue2 + 1;
		        }
		     }
		     //
		     // server #2 is available
		     //
		     if (server2_flag == 0 && queue2 > buffer) {
		        server2_flag = 1;
		        if (queue2 > 0) {
		            queue2 = queue2 -1;
		        }
		        service2_count = service2_count + 1;
		        // 
		         if (rnd_toggle < 0) {
		        server_time = 1+ Math.round(Math.random()*(s_time2)*10.0)/10.0;
		         }
		         else {
		            server_time = s_time2;
		         }
		        service2_time[service2_count] = server_time;
                                                server2_begin[service2_count] = (x4/6);
		        queue_length[service2_count] = queue;
		     }
		     //
		     if (server2_flag ==1) {
		         xy2 = xy2 +1;
		         if (xy2 > service2_time[service2_count]*6) {
		            server2_flag = 0;
		            xy2 = 0;
		            queue3 = queue3 + 1;
		        }
		     }
		     // server #3 available
		     if (server3_flag == 0 && queue3 > buffer) {
		         server3_flag = 1;
		         if (queue3 > 0) {
		            queue3 = queue3 -1;
		         }
		         service3_count = service3_count + 1;
		         //
		         if (rnd_toggle < 0) {
		        server_time = 1+ Math.round(Math.random()*(s_time3)*10.0)/10.0;
		        }
		         else {
		            server_time = s_time3;
		         }
		        service3_time[service3_count] = server_time;
                                                server3_begin[service3_count] = (x4/6);
		        queue_length[service3_count] = queue;
		     }
		     //
		     if (server3_flag ==1) {
		         xy3 = xy3 +1;
		         if (xy3 > service3_time[service3_count]*6) {
		            server3_flag = 0;
		            queue4 = queue4 + 1
		            xy3 = 0;
		        }
		     }
		     // server #4 is available
		     if (server4_flag == 0 && queue4 > buffer) {
		         server4_flag = 1;
		         if (queue4 > 0) {
		            queue4 = queue4 -1;
		         }
		         service4_count = service4_count + 1;
		         //
		          if (rnd_toggle < 0) {
		         server_time = 1+ Math.round(Math.random()*(s_time4)*10.0)/10.0;
		         }
		         else {
		            server_time = s_time4;
		         }
		         service4_time[service4_count] = server_time;
                                                 server4_begin[service4_count] = (x4/6);
		         queue_length[service4_count] = queue;
		     }
		     //
		     if (server4_flag ==1) {
		         xy4 = xy4 +1;
		         if (xy4 > service4_time[service4_count]*6) {
		             server4_flag = 0;
		             completed = completed + 1
		             xy4 = 0;
		         }
		    }
	        draw();
                    }
    }
    //
    function myStopFunction() {
      clearInterval(myVar);
    }
}
//
function draw() {  
            	var canvas = document.getElementById('incidence');  
            	if (canvas.getContext){  
               	    var gS2 = canvas.getContext('2d');  
            	}  
			//
			// Coordinate system
			// 
			gS2.fillStyle = "rgb(248,248,248)";
			gS2.fillRect(0,0,450,550);
			//
			gS2.fillStyle = "rgb(240,240,240)";
			gS2.fillRect(0,0,450,20);
			//
			gS2.fillRect(0,0,450,20);
			gS2.strokeStyle = "rgb(164,164,164)";
			gS2.lineWidth = "1";
			drawLine(0,21,450,21);
			//
			setColor("maroon");
			setFont("f2");
			// var t_time = 1+ s_time/2;
			gS2.fillText("Facilities and Servers ",150,16);
			//
			// axis
			//
			setColor("snow");
			gS2.fillRect(30,110,400,435);
			//
			setColor("white");
			for (i2=50;i2<430;i2=i2+20) {
			  drawLine(i2,110,i2,545);
			}
			for (i2=110;i2<570;i2=i2+20) {
			  drawLine(30,i2,440,i2);
			}
			setColor("silver");
			gS2.fillRect(30,150,400,20);
			gS2.fillRect(30,510,400,20);
			//
			gS2.fillRect(250,250,180,20);
			gS2.fillRect(250,330,180,20);
			gS2.fillRect(250,410,180,20);
			//
			setColor("maroon");
			gS2.font = "bold 14px Arial";
			gS2.fillText("Input",40,145);
			gS2.fillText("Output",40,505);
			//
			gS2.font = "bold 12px Arial";
			if (rnd_toggle < 0) {
			gS2.fillText("- Random server times -",150,130);
			}
			else {
			gS2.fillText("- Fixed server times -",150,130);
			}
			gS2.fillText("Required buffer stock: "+buffer,150,145);
			//
			setColor("black");
			drawLine(70,190,70,490);
			gS2.font = "10px Arial";
			for (i=1;i<9;i++) {
			gS2.fillText(""+i,67+i*20,190);
			}
			gS2.fillText("min.",240,190);
			gS2.font = "bold 14px Arial";
			for (i=1; i< 5;i++) {
			gS2.fillText("S #"+i,35,150+i*80);
			}
			//
			//
			//  the clock
			//
			setColor("black");
			gS2.beginPath();
			gS2.moveTo(60,60);
			gS2.arc(60,60,32,0,2.0*Math.PI);
			gS2.closePath;
                			gS2.fill();
			//
			gS2.fillStyle = "rgb(255,255,255)";
			gS2.beginPath();
			gS2.moveTo(60,60);
			gS2.arc(60,60,30,0,2.0*Math.PI);
			gS2.closePath;
                			gS2.fill();
			//
			setColor("white");
			gS2.beginPath();
			gS2.moveTo(60,60);
                			gS2.arc(60,60,5,0,(2.0)*Math.PI);
                			gS2.closePath;
                			gS2.fill();
                			//
			setColor("black");
			drawLine(28,60,92,60);
			drawLine(60,28,60,92);
			drawLine(45,33,75,87);
			drawLine(75,33,45,87);
			drawLine(35,46,85,74);
			drawLine(35,74,85,46)
			//
			gS2.fillStyle = "rgb(255,255,255)";
			gS2.beginPath();
			gS2.moveTo(60,60);
			gS2.arc(60,60,27,0,2.0*Math.PI);
			gS2.closePath;
                			gS2.fill();
			//
			gS2.fillStyle = "rgb(0,0,0)";
			gS2.beginPath();
			gS2.moveTo(60,60);
			gS2.arc(60,60,27,0,2.0*Math.PI);
			gS2.closePath;
                			gS2.fill();
			//
			gS2.fillStyle = "rgb(255,255,255)";
			gS2.beginPath();
			gS2.moveTo(60,60);
			gS2.arc(60,60,26,0,2.0*Math.PI);
			gS2.closePath;
                			gS2.fill();
			//
			setColor("navy");
			gS2.beginPath();
			gS2.moveTo(60,60);
                			gS2.arc(60,60,3,0,(2.0)*Math.PI);
                			gS2.closePath;
                			gS2.fill();
			//
			if (server1_flag == 0) {
			  setColor("thunder");
			}
			if (server1_flag == 1) {
			  setColor("thunder");
			}
			gS2.beginPath();
			gS2.moveTo(60,60);
                			gS2.arc(60,60,27,-0.5*Math.PI,(((x4*4)/720)-0.5)*Math.PI);
                			gS2.closePath;
                			gS2.fill();
			// 
			setColor("white");
			gS2.lineWidth = "1";
			//
			drawLine(33,60,87,60);
			drawLine(60,33,60,87);
			drawLine(45,33,75,87);
			drawLine(75,33,45,87);
			drawLine(35,46,85,74);
			drawLine(35,74,85,46)
			//
			setColor("white");
			gS2.beginPath();
			gS2.moveTo(60,60);
                			gS2.arc(60,60,2,0,(2.0)*Math.PI);
                			gS2.closePath;
                			gS2.fill();
			//
                			// header data (arrivals, queue, service...
			//
			gS2.fillStyle = "rgb(0,0,128)";
			gS2.font = "bold 12px Arial";
			temp = Math.round(x4/6);
			gS2.fillText("Time: 0 h:"+temp+" m",100,65);
			//
			if (arrival_total > 0) {
			  gS2.font = "12px Arial";
			  temp = Math.round(customer_arrive[1]*10.0)/10.0;
			  customer_arrive[1] = temp;
			  gS2.fillText("First customer arrives at:  "+customer_arrive[1]+" min.",110,100);
			  gS2.font = "bold 12px Arial";
			  gS2.fillStyle = "rgb(128,0,0)";
			  var width = gS2.measureText(customer_arrive[1]).width;
			  gS2.fillText(""+customer_arrive[1]+" min.",230-width,187);
			  // gS2.fillText("Total Arrivals: "+arrival_total,200,65)
			}
                			//
			// work here
			//
			gS2.fillStyle = "rgb(0,128,0)";
			gS2.font = "bold 12px Arial";
			//
			for (i=1; i< arrival_total+1;i++) {
			    color_index = color_index + 1;
			    if (color_index > 13) {
			       color_index = 0;
			   }
			   setColor(sb_code[5]);
			   // gS2.fillRect(80+i*10,127,8,10);
			}
			 // gS2.fillText("["+arrival_total+"]",85+i*10,137);
			//
			for (i=1; i< service4_count+1;i++) {
			    color_index = color_index + 1;
			    if (color_index > 13) {
			       color_index = 0;
			   }
			   setColor("white");
			   // gS2.fillRect(81+i*10,128,6,7);
			}
			//
			setColor("navy");
			gS2.font = "bold 12px Arial";
			gS2.fillText("Inventory: ",40,165);
			setColor("red");
			gS2.fillText("Buffer #2: ",192,265);
			gS2.fillText("Buffer #3: ",192,345);
			gS2.fillText("Buffer #4: ",192,425);
			//
			for (i=1; i<queue+1;i++) {
			   setColor("thunder");
			   gS2.fillRect(100+i*10,155,8,10);
			  setColor("navy");
			   drawRect(100+i*10,155,8,10);
			}
			if (queue > 0) {
			   gS2.fillText("["+queue+"]",105+i*10,165);
			}
			// ------------------------------------------------------------------------------------
			for (i=1; i< queue2+1;i++) {
			   setColor("red");
			   gS2.fillRect(242+i*10,255,8,10);
			}
			if (queue2 > 0) {
			    gS2.fillText("["+queue2+" items]",247+i*10,265);
			}
			// --------------------------------------------------------------------------------------
			for (i=1; i< queue3+1;i++) {
			   setColor("red");
			   gS2.fillRect(242+i*10,335,8,10);
			}
			if (queue3 > 0) {
			   gS2.fillText("["+queue3+" items]",247+i*10,345);
			}
			// -------------------------------------------------------------------------------------
			for (i=1; i< queue4+1;i++) {
			   setColor("red");
			   gS2.fillRect(242+i*10,415,8,10);
			}
			if (queue4 > 0) {
			   gS2.fillText("["+queue4+" items]",247+i*10,425);
			}
			//
			gS2.font = "bold 12px Arial";
			gS2.fillStyle = "rgb(0,0,128)";
			// gS2.fillText("Customer",40,165);
			gS2.fillStyle = "rgb(0,0,0)";
			gS2.fillText("Service Time",345,185);
			// gS2.fillText("Server idle",200,165)
			gS2.fillStyle = "rgb(0,0,128)";
			gS2.fillText("Completed:",35,525)
			// 
			// =======================================================
			//
			  gS2.font = "12px Arial";
			  if (server1_flag == 1) {
			   i = service1_count;
			   //
			  temp = Math.round(server1_begin[i]*10.0)/10.0;
			  server1_begin[i] = temp;
			   gS2.font = "10px Arial";
			  gS2.fillStyle = "rgb(0,0,128)";
			  var width = gS2.measureText(""+i).width;
			  gS2.fillText("Item: #"+i+" ("+service1_time[i]+" minutes)",75,210);
			  gS2.font = "10px Arial";
			  gS2.fillText("Progress",75,240);
			  setColor("navy");
			  // drawRect(90,178+i*15,10*service1_time[i],10);
			  drawRect(70,215,20*service1_time[i],15);
			  // drawRect(260,195,9,6*service1_time[i]);
			  gS2.fillStyle = "rgb(128,0,0)";
			   if (i< service1_count) {
			      // gS2.fillRect(90,178+i*15,10*service1_time[i],10);
			   }
			   //
			   gS2.fillStyle = "rgba(0,0,128,0.4)";
			   if (i==service1_count) { 
  			      j = (x4/6) - server1_begin[i];
			         if (j > service1_time[i]) {
			 	j = service1_time[i];
			 	// gS2.fillStyle = "rgba(128,0,128,0.5)";
			         }
			         // gS2.fillRect(90,178+i*15,j*10,10);
			         gS2.fillRect(70,215,j*20,15);
			         // gS2.fillRect(260,195,9,j*6);
  			    }
			    }
			   // =================================================
			  if (server2_flag == 1) {
			   i = service2_count;
			   //
			   temp = Math.round(server2_begin[i]*10.0)/10.0;
			   server2_begin[i] = temp;
			   gS2.fillStyle = "rgb(0,128,0)";
			   gS2.font = "10px Arial";
			   var width = gS2.measureText(""+i).width;
			   gS2.fillText("Item: #"+i+" ("+service2_time[i]+" minutes)",75,290);
			   gS2.font = "10px Arial";
			   gS2.fillText("Progress",75,320);
			   setColor("pine");
			   // drawRect(90,178+i*15,10*service2_time[i],10);
			   drawRect(70,295,20*service2_time[i],15);
			   gS2.fillStyle = "rgb(0,128,0)";
			   //
			   gS2.fillStyle = "rgba(0,128,0,0.5)";
			   if (i==service2_count) { 
  			      j = (x4/6) - server2_begin[i];
			         if (j > service2_time[i]) {
			 	j = service2_time[i];
			 	// gS2.fillStyle = "rgba(128,0,128,0.5)";
			         }
			         // gS2.fillRect(90,178+i*15,j*10,10);
			         gS2.fillRect(70,295,j*20,15);
			    }
			    }
			    // =================================================
			    if (server3_flag == 1) {
			    i = service3_count;
			    //
			    temp = Math.round(server3_begin[i]*10.0)/10.0;
			    server3_begin[i] = temp;
			    gS2.fillStyle = "rgb(128,0,128)";
			    gS2.font = "10px Arial";
			    var width = gS2.measureText(""+i).width;
			    gS2.fillText("Item: #"+i+" ("+service3_time[i]+" minutes)",75,370);
			    gS2.font = "10px Arial";
			    gS2.fillText("Progress",75,400);
			    setColor("purple");
			    // drawRect(90,178+i*15,10*service3_time[i],10);
			    drawRect(70,375,20*service3_time[i],15);
			    gS2.fillStyle = "rgb(128,0,128)";
			    //
			    gS2.fillStyle = "rgba(128,0,128,0.5)";
			    if (i==service3_count) { 
  			       j = (x4/6) - server3_begin[i];
			          if (j > service3_time[i]) {
			  	j = service3_time[i];
			 	// gS2.fillStyle = "rgba(128,0,128,0.5)";
			          }
			          // gS2.fillRect(90,178+i*15,j*10,10);
			          gS2.fillRect(70,375,j*20,15);
			     }
			    }
 			    // =================================================
			    if (server4_flag == 1) {
			    i = service4_count;
			    //
			    temp = Math.round(server4_begin[i]*10.0)/10.0;
			    server4_begin[i] = temp;
			    gS2.fillStyle = "rgb(128,0,0)";
			    gS2.font = "10px Arial";
			    var width = gS2.measureText(""+i).width;
			    gS2.fillText("Item: #"+i+" ("+service4_time[i]+" minutes)",75,450);
			    gS2.font = "10px Arial";
			    gS2.fillText("Progress",75,480);
			    setColor("maroon");
			    // drawRect(90,178+i*15,10*service4_time[i],10);
			    drawRect(70,455,20*service4_time[i],15);
			    gS2.fillStyle = "rgb(128,0,0)";
			    //
			    gS2.fillStyle = "rgba(128,0,0,0.5)";
			    if (i==service4_count) { 
  			       j = (x4/6) - server4_begin[i];
			          if (j > service4_time[i]) {
			  	j = service4_time[i];
			 	// gS2.fillStyle = "rgba(128,0,128,0.5)";
			          }
			          // gS2.fillRect(90,178+i*15,j*10,10);
			          gS2.fillRect(70,455,j*20,15);
			     }
			    }
			   // =================================================
			   // }
			  // gS2.fillStyle = "rgb(128,0,0)";
			  // gS2.fillText("["+service_time[i]+"]",95+10*service_time[i],187+i*15);
			  // var idle = (server_begin[i] - server_begin[i-1])-service_time[i];
			  // if (idle < 0) {
			  //   idle = 0;
			  // }
			  // temp = Math.round(idle*100.0)/100.0;
			  // idle = temp;
			  // var width = gS2.measureText(idle).width;
			  // gS2.fillText(""+idle,230-width,187+i*15);
			  //
			  for (i=1;i<completed+1;i++) {
			   if (i <= completed) {
			      gS2.fillStyle = "rgb(0,0,128)";
			      gS2.fillRect(90+i*15,515,10,10);
			      setColor("thunder");
			      gS2.fillRect(91+i*15,516,8,5);
			  }
			  if (i == completed) {
			      gS2.fillStyle = "rgb(0,0,128)";
			      var m = completed;
			      gS2.fillText("["+m+"]",105+i*15,525);
			  }
			 }
			//  ---------------------------------------------
			gS2.font = "bold 12px Arial";
			setColor("white");
			gS2.fillRect(270,195,80,50);
			//
			if (server1_flag == 1) {
			  setColor("gray");
			  drawRect(270,195,80,50);
			  gS2.fillStyle = "rgb(144,144,144)";
			  gS2.fillText("Server #1",282,215);
			  gS2.fillText("is busy",293,235);
			}
			if (server1_flag == 0) {
			  setColor("navy");
			  drawRect(270,195,80,50);
			  gS2.fillStyle = "rgb(0,0,128)";
			  gS2.fillText("Server #1",282,215);
			  gS2.fillText("is available",280,235);
			}
			gS2.fillStyle = "rgb(0,0,0)";
			gS2.fillText(""+s_time1+" minutes",360,210);
			var s1_utilization = 1.0/s_time1;
			temp = Math.round(s1_utilization*1000.0)/1000.0;
			s1_utilization = temp;
			gS2.fillText("("+s1_utilization+"%)",360,230);
			//  ---------------------------------------------------------------
			setColor("white");
			gS2.fillRect(270,275,80,50);
			//
			if (server2_flag == 1) {
			  setColor("gray");
			  drawRect(270,275,80,50);
			  gS2.fillStyle = "rgb(144,144,144)";
			  gS2.fillText("Server #2",282,295);
			  gS2.fillText("is busy",293,315);
			}
			if (server2_flag == 0) {
			  if (server_count == 1) {
			      setColor("pine");
			        gS2.fillStyle = "rgb(0,128,0)";
			  }
			  else {
			    setColor("gray");
			     gS2.fillStyle = "rgb(164,164,164)";
			 }
			 drawRect(270,275,80,50);
			  gS2.fillText("Server #2",282,295);
			  gS2.fillText("is available",280,315);
			}
			gS2.fillStyle = "rgb(0,0,0)";
			gS2.fillText(""+s_time2+" minutes",360,290);
			var s2_utilization = 1.0/s_time2;
			temp = Math.round(s2_utilization*1000.0)/1000.0;
			s2_utilization = temp;
			gS2.fillText("("+s2_utilization+"%)",360,310);
			// ---------------------------------------------------------------
			setColor("white");
			gS2.fillRect(270,355,80,50);
			//
			if (server3_flag == 1) {
			  setColor("gray");
			  drawRect(270,355,80,50);
			  gS2.fillStyle = "rgb(144,144,144)";
			  gS2.fillText("Server #3",282,375);
			  gS2.fillText("is busy",293,395);
			}
			if (server3_flag == 0) {
			  if (server_count == 1) {
			      setColor("purple");
			        gS2.fillStyle = "rgb(128,0,128)";
			  }
			  else {
			    setColor("gray");
			     gS2.fillStyle = "rgb(164,164,164)";
			 }
			//
			  drawRect(270,355,80,50);
			  gS2.fillText("Server #3",282,375);
			  gS2.fillText("is available",280,395);
			}
			gS2.fillStyle = "rgb(0,0,0)";
			gS2.fillText(""+s_time3+" minutes",360,370);
			var s3_utilization = 1.0/s_time3;
			temp = Math.round(s3_utilization*1000.0)/1000.0;
			s3_utilization = temp;
			gS2.fillText("("+s3_utilization+"%)",360,390);
			// --------------------------------------------------------------
			setColor("white");
			gS2.fillRect(270,435,80,50);
			//
			if (server4_flag == 1) {
			  setColor("gray");
			  drawRect(270,435,80,50);
			  gS2.fillStyle = "rgb(144,144,144)";
			  gS2.fillText("Server #4",282,455);
			  gS2.fillText("is busy",293,475);
			}
			if (server4_flag == 0) {
			  if (server_count == 1) {
			      setColor("maroon");
			        gS2.fillStyle = "rgb(128,0,0)";
			  }
			  else {
			    setColor("gray");
			     gS2.fillStyle = "rgb(164,164,164)";
			 }
			//
			  drawRect(270,435,80,50);
			  gS2.fillText("Server #4",282,455);
			  gS2.fillText("is available",280,475);
			}
			gS2.fillStyle = "rgb(0,0,0)";
			gS2.fillText(""+s_time4+" minutes",360,450);
			var s4_utilization = 1.0/s_time1;
			temp = Math.round(s4_utilization*1000.0)/1000.0;
			s4_utilization = temp;
			gS2.fillText("("+s4_utilization+"%)",360,470);
			// -------------------------------------------------------------
			// 
			// data table
			//
			var st_total = 0;
			var st_average = 0;
			var ql_total = 0;
			var ql_average = 0;
			var wt_total = 0;
			var wt_average = 0;
			//
			// results table
			//
			if (toggle > 0) {
			setColor("snow");
			// gS2.fillRect(459,51,219,414);
			 setColor("silver");
			drawRect(259,51,220,414);
			setColor("white");
			gS2.fillRect(263,66,213,480);
			//
			setColor("sky");
			gS2.fillRect(259,32,222,32);
			setColor("white");
			setFont("f2");
			gS2.fillText("",270,46);
			gS2.fillText("Item",267,61);
			gS2.fillText("Service",317,46);
			gS2.fillText("Time",322,61);
			gS2.fillText("",368,46);
			gS2.fillText("Queue",368,61);
			gS2.fillText("",425,46);
			gS2.fillText("",628,61);
			//
			for (j=0;j<20;j=j+1) {
			    setColor("silver");
			   drawRect(260,65+j*20,50,20);
			   drawRect(310,65+j*20,50,20);
			   drawRect(360,65+j*20,50,20);
			   drawRect(410,65+j*20,70,20);
			}
			//
			var s1_total = 0.0;
			var s1_utilization = 0.0;
			var s1_idle = 0.0;
			var s2_total = 0.0;
			var s2_utilization = 0.0;
			var s2_idle = 0.0;
			var s3_total = 0.0;
			var s3_utilization = 0.0;
			var s3_idle = 0.0;
			var s4_total = 0.0;
			var s4_utilization = 0.0;
			var s4_idle = 0.0;
			//
			for (i=1;i<=completed;i++) {
			   setColor("black");
			   setFont("f2");
			   //
			   var width = gS2.measureText(""+i).width;
			   gS2.fillText(""+i,285-(width/2),60+i*20);
			   //
			   setFont("f4");
			   st_total = service1_time[i]+service2_time[i]+service3_time[i]+service4_time[i];
			   temp = Math.round(st_total*100.0)/100.0;
			    var width = gS2.measureText(temp).width;
			   st_total = temp;
			   gS2.fillText(""+st_total,355-width,60+i*20);
			  //
			  temp = server1_begin[i];
			   var width = gS2.measureText(temp).width;
			   // queue_length[i] = temp;
			   gS2.fillText(""+temp,405-width,60+i*20);
			   //
			   s1_total = s1_total + service1_time[i];
			   s1_utilization = s1_total/60.0;
			   s1_idle = 60.0 - s1_total;
			   s2_total = s2_total + service2_time[i];
			   s2_utilization = s2_total/60.0;
			   s2_idle = 60.0 - s2_total;
			   s3_total = s3_total + service3_time[i];
			   s3_utilization = s3_total/60.0;
			   s3_idle = 60.0 - s3_total;
			   s4_total = s4_total + service4_time[i];
			   s4_utilization = s4_total/60.0;
			   s4_idle = 60.0 - s4_total;
			}
			//
			gS2.font = "bold 12px Arial";
			gS2.fillText("Server 1",265,60+21*20);
			gS2.fillText("Server 2",265,60+22*20);
			gS2.fillText("Server 3",265,60+23*20);
			gS2.fillText("Server 4",265,60+24*20);
			//
			gS2.font = "12px Arial";
			temp = Math.round(s1_utilization*1000.0)/10.0;
			s1_utilization = temp;
			var width = gS2.measureText(temp+"%").width;
			gS2.fillText(""+temp+"%",355-width,60+21*20);
			//
			temp = Math.round(s1_idle*10.0)/10.0;
			s1_idle = temp;
			var width = gS2.measureText(s1_idle).width;
			gS2.fillText(""+s1_idle,405-width,60+21*20);
			//
			temp = Math.round(s2_utilization*1000.0)/10.0;
			s2_utilization = temp;
			var width = gS2.measureText(temp+"%").width;
			gS2.fillText(""+temp+"%",355-width,60+22*20);
			//
			temp = Math.round(s2_idle*10.0)/10.0;
			s2_idle = temp;
			var width = gS2.measureText(s2_idle).width;
			gS2.fillText(""+s2_idle,405-width,60+22*20);
			//
			temp = Math.round(s3_utilization*1000.0)/10.0;
			s3_utilization = temp;
			var width = gS2.measureText(temp+"%").width;
			gS2.fillText(""+temp+"%",355-width,60+23*20);
			//
			temp = Math.round(s3_idle*10.0)/10.0;
			s3_idle = temp;
			var width = gS2.measureText(s3_idle).width;
			gS2.fillText(""+s3_idle,405-width,60+23*20);
			//
			temp = Math.round(s4_utilization*1000.0)/10.0;
			s4_utilization = temp;
			var width = gS2.measureText(temp+"%").width;
			gS2.fillText(""+temp+"%",355-width,60+24*20);
			//
			temp = Math.round(s4_idle*10.0)/10.0;
			s4_idle = temp;
			var width = gS2.measureText(s4_idle).width;
			gS2.fillText(""+s4_idle,405-width,60+24*20);
			//
			}
			if (toggle1 > 0) {
			  gS2.fillStyle = "rgb(255,255,255)";
			  gS2.fillRect(200,260,350,200);
			  gS2.fillStyle = "rgb(0,0,128)";
			  gS2.fillRect(202,262,346,198);
			  gS2.fillStyle = "rgb(255,255,255)";
			  gS2.fillRect(203,263,344,196);
			  setColor("sky");
			  gS2.fillRect(204,264,342,194);
			  gS2.fillStyle = "rgb(255,255,255)";
			  gS2.fillRect(205,265,340,192);
			  setColor("sky");
			  gS2.fillRect(205,265,340,18);
			  //
			  //  results...
			  //
			  gS2.font = "bold 12px Arial";
			  gS2.fillStyle = "rgb(255,255,255)";
			  gS2.fillText("Results...",250,278);
			  if (customer_count > 0) {
			    st_average = (st_total-service_time[customer_count])/(customer_count-1);
			    ql_average = ql_total/customer_count;
			    wt_average = wt_total/customer_count;
			    gS2.fillStyle = "rgb(0,0,0)";
			    gS2.fillText("Total number of customer arrivals (per hour): "+arrival_total,220,300);
			    gS2.fillText("Total number of customers served: "+customer_count,220,315);
			    temp = Math.round(st_average*100.0)/100.0;
			    st_average = temp;
			    gS2.fillText("Average service time: "+st_average+" minutes",220,335);
			    temp = Math.round(ql_average*100.0)/100.0;
			    ql_average = temp;
			    gS2.fillText("Average Queue length: "+ql_average+" customers",220,355);
			    temp = Math.round(wt_average*100.0)/100.0;
			    wt_average = temp;
			    gS2.fillText("Average Wait time: "+wt_average+" minutes",220,375);
			    gS2.fillText("Average Time in the system",220,395);
			    var utilization = st_total/((x4/6)*server_count);
			    temp = Math.round(utilization*100.0)/100.0;
			    utilization = temp*100.0;
			    gS2.fillText("Server utilization: "+utilization+" %",220,415);
			}
			}
}
</script>  

      <style type="text/css">  
            canvas { border: 0px solid black; }  
      </style>

</head>  

<body onload="init1();">
<form>
<table border = "0" cellspacing = "0" cellpadding = "0">
  <tr>
    <td width="450">
         <canvas id="incidence" width="450" height="550" bgcolor="white"></canvas>  
    </td>
 
    <td style = "margin-top: 20px; border-left: solid thin #a0a0a0;" align="center" bgcolor="#f0f0f0" width="350" height="50">
     <hr/>
     <span style = "color: #000000" text-align:center; font-weight: bold;"><b>Average Service Time</b> </span><br/><br/>
     <span style="color: #000088;" font-weight: bold;"><b>Server #1: </b></span>
     <input type = "number" style = "width: 50px; text-align: right;" name="bidx" min="1" max="8" value = "3.00" step="0.50" onchange="doit1(this.form.bidx.value);"/> min.<br/><br/>
      
     <span style="color: #008800;" font-weight: bold;"><b>Server #2: </b></span>
     <input type = "number" style = "width: 50px; text-align: right;" name="bidy" min="1" max="8" value = "3.00" step="0.50"  onchange="doit2(this.form.bidy.value);"/> min.<br/><br/>
     
  <span style="color: #880088;" font-weight: bold;"><b>Server #3: </b></span>
     <input type = "number" style = "width: 50px; text-align: right;" name="bidz" min="1" max="8" value = "3.00" step="0.50"  onchange="doit3(this.form.bidz.value);"/> min.<br/><br/>

     <span style="color: #880000;" font-weight: bold;"><b>Server #4: </b></span>
     <input type = "number" style = "width: 50px; text-align: right;" name="bidw" min="1" max="8" value = "3.00" step="0.50" onchange="doit4(this.form.bidw.value);"/> min.
        <hr/>
  <span style="color: #000000;" font-weight: bold;"><b>Minimum buffer stock: </b></span>
     <input type = "number" style = "width: 50px; text-align: right;" name="bidb" min="0" max="5" value = "0.00" step="1.0" onchange="doit5(this.form.bidb.value);"/> units
        <hr/>
      </td>
  </tr>
  <tr>
     <td width = "450" align = "right" bgcolor = "#dedede">
     <input type="button" value="Go!" onclick="runner();"/>&nbsp;
     <input type="button" value="Results" onclick="summary();"/>
      </td>
    <td width = "350" bgcolor = "#dedede">
     <input type="button" value="Random" onclick="randomize();"/>
    <input type="button" value="Reset" onclick="init1();"/>
     </td>
  </tr>
</table>
</form>
</body>
</html>
